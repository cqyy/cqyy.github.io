---
layout: post
title: Bigtable
description: "Bigtable:A distributed storage system for structured data"
modified: 2014-10-26
tags: [数据库]
imagefeature: cs-4.jpg
category: DataBase
comments: true
share: true
---

## 1.Overview

BigTable是有Google设计实现的分布式非关系数据库，可管理PB级别的数据，包含上千台服务器组成的集群。Bigtable提供了灵活、高性能的结构化数据存储服务。

## 2.Data Model

Bigtable可以简单的理解为一个 稀疏、分布式、持久、多版本的有序Map。该Map通过row key,column key,timestamp进行索引，值为任意的byte数组。

>（row key,column key,timestamp） => string

###2.1 Rows

Row key为任意字符串，并按字典顺序进行排序。在单一row key下的读或写操作都是原子的。

对于一个表，Bigtable根据row key的范围进行分片，每片叫***`tablet`***，这是进行负载均衡和任务分配的基本单位（类似于GFS中的Block，但该分片为逻辑意义）。因此，同一范围的数据将存储在相近的位置，小范围数据的读取也将非常有效，因为只需要和很少的机器通信。

应用也可以利用该特性来提高应用性能，Google内部的Webtable就是一个例子：Webtable存储各种网页的内容和元数据，其将row key设置为该网页网址的逆序（和java包命名规则一样），使得url相近的web内容存储在相近的位置。

###2.2 Column Families

Column family是指将相关的数据组成一组，使得在分布式存储的情况下，可以更高效的访问数据。Bigtable中，Column family为最基本的访问控制单元。

传统情况下，数据以表形式进行存储，应用的任何数据访问都将读取表中的完整行，即包含读取行的所有列信息。对于Bigtable应用场景中，每个表所包含的列数量将比较巨大，而应用读取数据绝大部分情况下只是对其中的某一部分感兴趣，若读取所用行数据则效率低下。通过Column Family方式，将列按数据的逻辑属性进行分类（分类由应用完成），不同分类的数据分别存储，使得在读取的时候，可以仅仅读取部分列数据提高效率。

Bigtable中，Column family中的数据通常为同一属性，并且必须在插入数据前创建，通过如下语法创建：*family:qualifier*。


###2.3 Bigtable vs. Relational DataModels

<figure><img src="/images/bigtable/datamodel.png"/></figure>
传统关系数据库模型中，学生选课关系通过三个表进行存储，表之间通过主键与外键建立联系。
而在Bigtable模型中，以分别以学生ID和课程ID建立两个表进行存储。可以看到学生有两个Column Family：info和course。如此，访问学生个人信息只需要读取info这Column Family即可。